<template>
    <div>
        <div class="result">
            <a-breadcrumb>
                <a-breadcrumb-item>首页</a-breadcrumb-item>
                <a-breadcrumb-item><a href="">排课计划</a></a-breadcrumb-item>
                <a-breadcrumb-item><a href="">开始排课</a></a-breadcrumb-item>
            </a-breadcrumb>
        </div>
        <div class="content">
            <a-row>
                <a-col :span="17"><span style="font-size:1.5em">{{this.planData}}</span></a-col>
                <a-col>
                    <button style="background-color: blue;
                        color: white;
                        height: 40px;
                        border: none;
                        border-radius: 5px;
                        float: right;
                        width: 100px" @click="back">返回</button>
                </a-col>
            </a-row>
        </div>
        <!-- /result -->
        <div class="table-bg">
            <a-row class="buttons">
                <a-col :span="3"><a-button style="width: 100px;height: 40px" @click="timesSetting">课时设置</a-button></a-col>
                <a-col :span="3"><a-button style="width: 100px;height: 40px" @click="oncesSetting" >课节设置</a-button></a-col>
                <a-col :span="3"><a-button style="width: 100px;height: 40px" @click="placeSetting">教室设置</a-button></a-col>
                <a-col :span="3"><a-button style="width: 100px;height: 40px" @click="courseSetting">课程设置</a-button></a-col>
                <a-col :span="3"><a-button style="width: 100px;height: 40px;background-color:#b9b9b9" @click="startArray">开始排课</a-button></a-col>
            </a-row>
            <a-row style="margin-top: 50px;margin-left: 100px">
                <a-form-model :model="form" ref="ruleForm" :label-col="{ span:2}" :wrapper-col="{ span: 18}">
                    <a-form-model-item label="任务名称：" ref="task" prop="task">
                        <a-input  placeholder="1234" style="width: 580px" v-model="form.task" />
                    </a-form-model-item>
                </a-form-model>
            </a-row>
                <button style="background-color: #00ccff;float: right;color: white;height: 40px;border: none;border-radius: 5px;margin-top: 200px;width: 200px" @click="saveTask">保存</button>
        </div>
    </div>
</template>
<script>
    import {message} from "ant-design-vue"
    export default {
        data() {
            return {
                planId:"",
                planData:"",
                type:"",
                form:{
                },
            };
        },
        created() {
          this.chooseCourseInfo();
        },
        methods:{
            //获取单个选课计划信息
            async chooseCourseInfo(){
                let queryString = (window.location.hash || " ").split('?')[1]
                let planId = (queryString || " ").split('=')[1]
                this.planId = planId;
                if (planId) {
                    //获取单个选课计划的信息
                    let {data: {result, success}} = await this.$api.schedule.plan.schedulegetInfo({planId})
                    this.planData = result.name
                    this.type=result.type;
                    console.log(this.type);
                }
            },
            //课时设置
            timesSetting(){
                this.$router.push(`/schedule/detail/sort_course/index?planId=${this.planId}`)
            },
            //课节设置
            oncesSetting(){
                this.$router.push(`/schedule/detail/sort_course/time?planId=${this.planId}`)
            },
            //教室设置
            placeSetting(){
                this.$router.push(`/schedule/detail/sort_course/place?planId=${this.planId}`)
            },
            //课程设置
            courseSetting(){
                this.$router.push(`/schedule/detail/sort_course/course/index?planId=${this.planId}`)
            },
            //开始排课
            startArray(){
                this.$router.push(`/schedule/detail/start_class?planId=${this.planId}`)
            },
            //返回
            back(){
                this.$router.go(-1)
            },
            //保存开始排课
            async saveTask(){
                // console.log(this.form.task);
                // console.log(this.planId);
                let {data}=await this.$api.schedule.arrangeClass.updateSchedule({planId:this.planId,taskName:this.form.task})
                console.log(data);
                if(data&&data.success){
                    if(this.type===1){
                        this.$router.push(`/schedule/detail/task_admin/index?planId=${this.planId}`)
                    }else{
                        this.$router.push(`/schedule/detail/task_mobile/index?planId=${this.planId}`)

                    }

                }else{
                    message.error(data.message);
                }
            },
        }
    };
</script>

<style lang="less" scoped>
    .result{
        width: 100%;
        background-color: white;
        height:50px;
        margin: 20px 0px 10px 0px;
        padding-left: 25px;
        padding-top: 15px;
        vertical-align: top;
        border-radius: 5px;
    }
    .content{
        width: 100%;
        height: 300px;
        background-color: white;
        height: 100px;
        margin: 0px 0px 20px 0px;
        padding: 20px 25px;
        vertical-align: top;
        border-radius: 5px;
    }
    .table-bg{
        background-color: white;
        margin: 0px 0px 20px 0px;
        padding: 20px 25px;
        border-radius: 5px;
        text-align: center;
        width: 100%;
        height: 500px;
    }
    .buttons{
        margin:5px 5px 20px 5px;
        padding:2px 4px;
    }
    .buttons button{
        background-color:#e4e4e4;
        color:black;
    }
    .time1{
        width: 100%;
        height: 30px;
        padding-top:5px;
        background-color: #d9d9d9;
    }

</style>
